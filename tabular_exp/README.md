# GFast implementation of MLP on heart disease dataset

## Running GFast

To run GFast on the MLP, run:

```console
sh main.sh
```

## Description of files

**data/:** contains preprocessing pipeline for the heart disease dataset. The MLP is trained on categorical variables based on `preprocess_models.py`. To reduce the number of categories, as well as to convert floating numbers to categorical variables, we use the function `convert_to_categorical` from `utils.py`.

**model/:** contains the MLP `heart_disease_model.pth`. It also contains the one-hot encoder `heart_disease_encoder.pkl` and the set of qs used `heart_disease_qs.npy`. 


## Description of the tabular_results folder

**tabular_results/:** stores all results generated by q-sft and GFast, plus a CSV containing all the results. By running `sh main.sh` folders will be created in `tabular_results/` with the various experiments ran. Below is a brief description of files that are present if you go into each folder inside `heart_disease_{method}/q{q}_n{n}_b{b}_d{d}/`:
- **test/:** contains the 10,000 testing samples used upon recovering Fourier coefficients
- **train/:** contains all samples used to recover Fourier coefficients
- **helper_results.txt:** summary statistics of GFast run
- **magnitude_of_interactions.png:** overview of the interacitons recovered 
- **nmse.png:** only generated with hyperparam=True. Summary of tuning `noise_sd`
- **gfast_transform.pickle:** Fourier coefficients recovered