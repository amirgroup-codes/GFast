# GFast implementation of MLP

## Running GFast

To run GFast on the MLP, run:

```console
sh main.sh
```

`main.sh` will call `get_qary_indices.py` to generate the generalized q-ary indices, `compute_samples.py` to compute the sample values from the MLP, and `run_gfast.py` to run GFast.

## Description of files

**model/:** contains the MLP `mlp.pt`. Additionally, the `avGFP.fasta` file is also present in this folder. The model weights of the first layer have been extracted from `mlp.pt` and left in `model_weights.npy`.

**src/:** necessary files to run GFast

## Description of the gfp_results folder

**gfp_results/:** stores all results generated by q-sft and GFast, plus a CSV containing all the results. By running `sh main.sh` folders will be created in `gfp_results/` with the various experiments ran. Below is a brief description of files that are present if you go into each folder inside `q{q}_n{n}_{delays_method_channel}_{threshold}/`:
- **test/:** contains the 10,000 testing samples used upon recovering Fourier coefficients
- **train/:** contains all samples used to recover Fourier coefficients
- **helper_results.txt:** summary statistics of GFast run
- **magnitude_of_interactions.png:** overview of the interacitons recovered 
- **nmse.png:** only generated with hyperparam=True. Summary of tuning `noise_sd`
- **gwht.pkl:** Fourier coefficients recovered

In addition to the CSVs provided, we provide the results folders for each experiment in the figshare data repository under accession code [28414232](https://figshare.com/articles/dataset/GFast/28414232).

Each folder is labelled as `delta{delta}_b{b}_d{d}` where `delta=0` for q-SFT and `delta=1` for GFast, `b` is the subsampling dimension, and `d` is the number of repeats.